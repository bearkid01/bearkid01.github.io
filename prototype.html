<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-theme.min.css" rel="stylesheet">

<style type="text/css">
#boroughs {
  stroke: grey;
  stroke-width: 2px;
  fill: steelblue;
}

.background {
  fill: none;
  pointer-events: all;
}

div#text{
  width: 300px;
  left: 120px;
  top: 1500px;
  position: absolute;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

div#text2{
  width: 300px;
  left: 520px;
  top: 1500px;
  position: absolute;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

</style>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">MSN 622</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="index.html#homework">Homework</a></li>
                <li><a href="index.html#project">Project</a></li>
                <li><a href="index.html#participation">Participation</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>
  
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>

<div id="text">
<h3>Functionality</h3>
<section>
  <h4>C-Level: Tableau Prototype of Line Chart, Bar Chart and Bubble Chart</h4>
  <h4>B-Level: D3 Implementation of Line Chart, Bar Chart and Bubble Chart</h4>
</section>

<h3>Data Preprocessing</h3>
  <p>
    All the data preprocessing work was done in R. I used the "plyr" library to aggregate the dataset. For example, 
    in order to get the average budget of all the movies filmed/released in different years, I applied "ddply" function to help me generate a new data frame with two columns, year and average budget. 
  </p>
</div>

<div id="text2">
<h3>User Guide</h3>
  <p>
    <ul>
      <li>Line Plot: move the mouse over the line plot to see the tooltips which show the average movie budget over the years.</li>
      <li>Bar Plot: move the mouse over the bars to see the tooltips which show the average movie budget for different mpaa movie categories in a given year.</li>
      <li>Bubble Plot: move the mouse over the bubbles to see the tooltips which show the budget for movies in a specific mpaa category in a given year.</li>
    </ul>
  </p>

<h3>Motivation</h3>
  <p>For C-level functionality, I focused on creating a basic line plot, a basic bar plot and a basic bubble plot in Tableau. For B-level functionality, I wanted to add some functionality for interactive visualization. Since it is hard to see the y values in a line plot, I added tooltips for the line plot. For A-level functionality, I want to add even more interactivity. For example, if a user clicks on the points in line chart, the bar plot will automatically show the break-down of average budget of that year in terms of average budget of movies by mpaa category. Furthermore, if the user clicks on the bars in the bar plot, the bubble plot below will show the break-down of budget for movies made/released in that mpaa category in the same year. 
  </p>
  <p>You can view the complete codes for these plots <a href="https://github.com/bearkid01/spring-2015-msan622_Vis/blob/gh-pages/homework_four.html">here</a>.
  </p>
  <p>Producer: Weiwei Zhang
  </p>
</div>

<script>

var margin = {top: 200, right: 20, bottom: 30, left: 100},
    width = 800 - margin.left - margin.right,
    height = 650 - margin.top - margin.bottom,
    padding = -120,
    centered;

var projection = d3.geo.mercator()
    .center([-73.94, 40.70])
    .scale(50000)
    .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", height)
    .on("click", clicked);

var g = svg.append("g");

d3.json("nyc.json", function(error, nyb) {
  g.append("g")
      .attr("id", "boroughs")
    .selectAll(".state")
      .data(nyb.features)
    .enter().append("path")
    .attr("class", function(d){ return d.properties.name; })
      .attr("d", path)
      .on("click", clicked);

  // g.append("path")
  //     .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
  //     .attr("id", "borough-borders")
  //     .attr("d", path);

});

function clicked(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 4;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 1;
    centered = null;
  }

  g.selectAll("path")
      .classed("active", centered && function(d) { return d === centered; });

  g.transition()
      .duration(750)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", 1.5 / k + "px");
}

</script>
